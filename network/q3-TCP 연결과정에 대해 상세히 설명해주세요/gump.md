# 정리

전반적인 흐름은 이전에 정리했어요.

[[Network] OSI 7계층이란?](https://livenow14.tistory.com/54?category=993618)

[[Network] http의 특징과 각각에 대해 간략히 설명해 주세요](https://livenow14.tistory.com/45?category=993618)

<br>

TCP는 TCP/IP 모델의 3계층인 트랜스포트 계층의 프로토콜이에요. 

Port번호를 사용하여 도착지 컴퓨터의 최종 도착지인 `프로세스`에 까지 데이터가 도달하게 하는 모듈(함수)에요.

데이터를 `세그먼트(Segment, 출발지, 목적지 PORT, 전송 제어, 순서 검증 정보)`로 감싸요

데이터 전달 보증, 순서를 보장 할 수 있는 이유는 3Way handshake과정이 있기 때문이에요.

애플리케이션 계층과 트랜스포트 계층 사이에는 **소켓**이라는 것이 존재해요. 소켓은 네트워크(트랜스포트 게층)에서 프로세스(애플리케이션)로 데이터를 전달하며, 프로세스로부터 네트워크로 데이터를 전달하는 출입구 역할을 해요.

그러므로 수신 측 호스트의 트랜스포트 계층은 실제로 데이터를 직접 프로세스로 전달하지 않아요. 주어진 시간에 수신측 호스트에 하나 이상의 소켓이 있을 수 있으므로, 각각의 소켓은 유일한 식별자를 가져요. 이 식별자의 포맷은 `UDP 소캣`인지, `TCP 소캣`인지에 따라 달라져요.

이때 트랜스포트 계층 세그먼트의 데이터를 올바른 소켓으로 전달하는 작업을 역다중화, 그 반대를 다중화라 해요.

> 좀더 깊은 얘기는 이번 포스트에서 안다루기로 해요.

 

## TCP **프로세스 연결 과정**

TCP는 연결지향 프로토콜로, 클라이언트와 서버가 서로에게 데이터를 보내기 전, 먼저 TCP 연결 설정을 할 필요가 있음을 의미해요.

TCP연결을 생성할 때 클라이언트 소켓 주소(IP 주소와 포트 번호)와 서버 소켓 주소(IP 주소와 포트 번호)를 연결과 연관시켜요.

TCP연결이 설정된 후, 한쪽에서 다른 쪽으로 데이터를 보내려면 소켓을 통해 데이터를 TCP 연결로 보내면 돼요.

UDP에서는 서버가 패킷을 소켓에게 제공하기 전 패킷에 목적지 주소를 붙여햐 하지만. TCP는 그렇지 않다는것이 다른점이에요.

![https://user-images.githubusercontent.com/48986787/120215180-64e83f80-c270-11eb-9b26-f93136ae12a2.png](https://user-images.githubusercontent.com/48986787/120215180-64e83f80-c270-11eb-9b26-f93136ae12a2.png)

서버 프로그램은 임의의 컴퓨터에서 수행되고 있는 클라이언트로부터의 초기 접속을 처리하는 `특별한 출입문(즉, 특별한 소켓)`을 가져야 해요. 여기서는 환영소켓이라 불러요. 

서버 프로세스가 실행되면, 클라이언트 프로세스는 서버로 TCP 연결을 시도해요. 이러한 초기 접속을 "출입문을 두드리는 것"으로 표현해요. 이는 클라이언트 프로세스에서 TCP 소켓을 생성함으로써 가능해요.

클라이언트는 TCP 소켓을 생성할 때 서버에 있는 `환영(welcom)소켓`의 주소, 즉 `서버의 IP 주소와 소켓의 포트 번호`를 명시해요. 소켓을 생성한 후 서버에게 3-way 핸드세이크를 시도해요. 이상이 없다면, 서버는 이 클라이언트에게 지정된 연결 소켓을 생성해요. 즉, 그림과 같이 TCP 연결이 설정돼요.

전송 계층에서 일어나는 3-way 핸드세이크를 클라이언트와 서버 프로그램은 전혀 인식하지 못해요.

> 전반적인 프로세스 연결 과정은 확인했는데, 그래서 3-way 핸드세이크는 어떻게 이뤄지죠?

간략화된 3-way 핸드셰이크 부분을 조금더 들어가보도록 해요.

## **TCP 연결과정(3-way 핸드셰이크)**

![https://user-images.githubusercontent.com/48986787/120218814-3e78d300-c275-11eb-96a7-45fac107cb45.png](https://user-images.githubusercontent.com/48986787/120218814-3e78d300-c275-11eb-96a7-45fac107cb45.png)

<br>

# 질문

## 나만 알만한 것

### 질문

TCP 연결설정이 완료되고, 데이터 이동시에 세그먼트가 가지는 값들은 어떤것들이 있을까요?

### 답변

<br>

## 진짜 궁금한 것

### 질문

각 단계에서 연결이 끊겼을 때 일어나는 일들.