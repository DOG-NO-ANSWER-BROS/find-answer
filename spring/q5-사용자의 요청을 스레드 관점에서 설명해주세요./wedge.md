# 사용자의 요청이 들어왔을 때
1. 스프링이 연동하고 있는 서블릿 컨테이너<sup>[1](#footnote1)</sup>에서 웹 요청에 대한 스레드를 생성한다.
2. 위 요청을 자세히 들여다보면, 서블릿 컨테이너는 오픈한 서버 포트에 대해 들어온 요청에 대해서 새로운 소켓을 생성해 연결을 수립한다. 
3. 이 과정에서 서블릿 컨테이너는 JVM 상에 스레드 하나를 생성하고, 해당 스레드가 url에 맵핑된 서블릿<sup>[2](#footnote2)</sup>의 service메소드를 호출할 수 있게 한다.  
4. 해당 스레드는 서블릿의 요청을 유저에게 응답하고 나면 destory 되거나, 스레드 풀<sup>[3](#footnote3)</sup>을 활용한 경우 스레드 풀로 자원이 반납된다. 
5. 톰캣을 비롯한 상용 서블릿 컨테이너가 멀티스레딩을 지원하는 이유는 여러 클라이언트의 요청을 동시에 병렬적으로 처리하기 위해서이다. 

## 질문
1. 개인 PC와 서버가 감당할 수 있는 스레드의 개수는 어떻게 확인할 수 있을까? 스레드에 대한 부하테스트를 하는 방법이 궁금하다. 현재는 멀티 스레드의 동작 방식이 궁금할 땐 크롬을 여러 개 열어놓고 손으로 클릭하여 다중 접속 환경을 모사하는데, 스마트한 방법으론 뭐가 있을지!


<a name="footnote1">[1] 스프링부트는 기본적으로 톰캣(Tomcat)을 내장하고 있다. 톰캣이 아닌 서블릿 컨테이너는 [제로니모](http://geronimo.apache.org/), [글래스피쉬](https://javaee.github.io/glassfish/) 등이 있다.</a>

<a name="footnote2">[2] 스프링 같은 경우 프론트 컨트롤러 패턴을 활용해 dispatcher servlet 하나만을 생성하여 사용한다.</a>

<a name="footnote3">[3] 톰캣은 스레드 풀로 [org.apache.catalina.Executor](https://tomcat.apache.org/tomcat-9.0-doc/config/executor.html)를 활용한다. api를 살펴보면 최대 스레드 풀 생성 개수(200)나 최소 유휴 스레드 개수(25) 등의 기본값을 알 수 있다.</a>
